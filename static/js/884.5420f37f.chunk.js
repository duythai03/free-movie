"use strict";(self.webpackChunkfree_movie=self.webpackChunkfree_movie||[]).push([[884],{884:(t,i,s)=>{s.r(i),s.d(i,{HLSProvider:()=>o});var e=s(607),n=s(108);s(43);class a{constructor(t,i){this.m=t,this.b=i,this.d=null,this.rb=null,this.sb={},this.tb=new Set}get instance(){return this.d}setup(t){const{streamType:i}=this.b.$state,s=(0,e.peek)(i).includes("live"),a=(0,e.peek)(i).includes("ll-");this.d=new t({lowLatencyMode:a,backBufferLength:a?4:s?8:void 0,renderTextTracksNatively:!1,...this.sb});const r=this.Pi.bind(this);for(const e of Object.values(t.Events))this.d.on(e,r);this.d.on(t.Events.ERROR,this.R.bind(this));for(const e of this.tb)e(this.d);this.b.player.dispatch("hls-instance",{detail:this.d}),this.d.attachMedia(this.m),this.d.on(t.Events.AUDIO_TRACK_SWITCHED,this.Ri.bind(this)),this.d.on(t.Events.LEVEL_SWITCHED,this.Si.bind(this)),this.d.on(t.Events.LEVEL_LOADED,this.Ti.bind(this)),this.d.on(t.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.Ui.bind(this)),this.d.on(t.Events.CUES_PARSED,this.Vi.bind(this)),this.b.qualities[n.kW.Ja]=this.ke.bind(this),(0,e.listenEvent)(this.b.qualities,"change",this.le.bind(this)),(0,e.listenEvent)(this.b.audioTracks,"change",this.me.bind(this)),this.rb=(0,e.effect)(this.ne.bind(this))}ba(t,i){return new e.DOMEvent((t=>(0,e.camelToKebabCase)(t))(t),{detail:i})}ne(){if(!this.b.$state.live())return;const t=new n.e8(this.oe.bind(this));return t.Ya(),t.aa.bind(t)}oe(){var t,i;this.b.$state.liveSyncPosition.set(null!==(t=null===(i=this.d)||void 0===i?void 0:i.liveSyncPosition)&&void 0!==t?t:1/0)}Pi(t,i){var s;null===(s=this.b.player)||void 0===s||s.dispatch(this.ba(t,i))}Ui(t,i){const s=this.ba(t,i);let e=-1;for(let r=0;r<i.tracks.length;r++){var a;const t=i.tracks[r],o=null!==(a=t.subtitleTrack)&&void 0!==a?a:t.closedCaptions,d=new n.to({id:"hls-".concat(t.kind,"-").concat(r),src:null===o||void 0===o?void 0:o.url,label:t.label,language:null===o||void 0===o?void 0:o.lang,kind:t.kind,default:t.default});d[n.Hp.na]=2,d[n.Hp.ib]=()=>{"showing"===d.mode?(this.d.subtitleTrack=r,e=r):e===r&&(this.d.subtitleTrack=-1,e=-1)},this.b.textTracks.add(d,s)}}Vi(t,i){var s;const e=null===(s=this.d)||void 0===s?void 0:s.subtitleTrack,n=this.b.textTracks.getById("hls-".concat(i.type,"-").concat(e));if(!n)return;const a=this.ba(t,i);for(const r of i.cues)r.positionAlign="auto",n.addCue(r,a)}Ri(t,i){const s=this.b.audioTracks[i.id];if(s){const e=this.ba(t,i);this.b.audioTracks[n.jH.fa](s,!0,e)}}Si(t,i){const s=this.b.qualities[i.level];if(s){const e=this.ba(t,i);this.b.qualities[n.jH.fa](s,!0,e)}}Ti(t,i){if(this.b.$state.canPlay())return;const{type:s,live:a,totalduration:r,targetduration:o}=i.details,d=this.ba(t,i);this.b.delegate.c("stream-type-change",a?"EVENT"===s&&Number.isFinite(r)&&o>=10?"live:dvr":"live":"on-demand",d),this.b.delegate.c("duration-change",r,d);const h=this.d.media;-1===this.d.currentLevel&&this.b.qualities[n.kW.Xa](!0,d);for(const e of this.d.audioTracks){const t={id:e.id.toString(),label:e.name,language:e.lang||"",kind:"main"};this.b.audioTracks[n.jH.ea](t,d)}for(const e of this.d.levels){var l,c;const t={id:null!==(l=null===(c=e.id)||void 0===c?void 0:c.toString())&&void 0!==l?l:e.height+"p",width:e.width,height:e.height,codec:e.codecSet,bitrate:e.bitrate};this.b.qualities[n.jH.ea](t,d)}h.dispatchEvent(new e.DOMEvent("canplay",{trigger:d}))}R(t,i){var s;if(i.fatal)if("mediaError"===i.type)null===(s=this.d)||void 0===s||s.recoverMediaError();else this.rc(i.error)}rc(t){this.b.delegate.c("error",{message:t.message,code:1,error:t})}ke(){this.d&&(this.d.currentLevel=-1)}le(){const{qualities:t}=this.b;this.d&&!t.auto&&(this.d[t.switch+"Level"]=t.selectedIndex,n.G_&&(this.m.currentTime=this.m.currentTime))}me(){const{audioTracks:t}=this.b;this.d&&this.d.audioTrack!==t.selectedIndex&&(this.d.audioTrack=t.selectedIndex)}Wi(t){var i;(0,e.isString)(t.src)&&(null===(i=this.d)||void 0===i||i.loadSource(t.src))}Xi(){var t,i;null===(t=this.d)||void 0===t||t.destroy(),this.d=null,null===(i=this.rb)||void 0===i||i.call(this),this.rb=null}}class r{constructor(t,i,s){this.M=t,this.b=i,this.Ma=s,this.re()}async re(){const t={onLoadStart:this.Na.bind(this),onLoaded:this.ub.bind(this),onLoadError:this.se.bind(this)};let i=await async function(t){var i;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,e.isString)(t))return;null===(i=s.onLoadStart)||void 0===i||i.call(s);try{var a;if(await(0,n.k0)(t),!(0,e.isFunction)(window.Hls))throw Error("");const i=window.Hls;return null===(a=s.onLoaded)||void 0===a||a.call(s,i),i}catch(o){var r;null===(r=s.onLoadError)||void 0===r||r.call(s,o)}return}(this.M,t);if((0,e.isUndefined)(i)&&!(0,e.isString)(this.M)&&(i=await async function(t){var i;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,e.isUndefined)(t))return;if(null===(i=s.onLoadStart)||void 0===i||i.call(s),t.prototype&&t.prototype!==Function){var n;return null===(n=s.onLoaded)||void 0===n||n.call(s,t),t}try{var a;const i=null===(a=await t())||void 0===a?void 0:a.default;if(!i||!i.isSupported)throw Error("");var r;return null===(r=s.onLoaded)||void 0===r||r.call(s,i),i}catch(d){var o;null===(o=s.onLoadError)||void 0===o||o.call(s,d)}return}(this.M,t)),!i)return null;if(!i.isSupported()){const t="[vidstack] `hls.js` is not supported in this environment";return this.b.player.dispatch(new e.DOMEvent("hls-unsupported")),this.b.delegate.c("error",{message:t,code:4}),null}return i}Na(){this.b.player.dispatch(new e.DOMEvent("hls-lib-load-start"))}ub(t){this.b.player.dispatch(new e.DOMEvent("hls-lib-loaded",{detail:t})),this.Ma(t)}se(t){const i=(0,n.rv)(t);this.b.player.dispatch(new e.DOMEvent("hls-lib-load-error",{detail:i})),this.b.delegate.c("error",{message:i.message,code:4,error:i})}}class o extends n.Nw{constructor(){super(...arguments),this.$$PROVIDER_TYPE="HLS",this.sc=null,this.e=new a(this.video,this.b),this.pa="".concat("https://cdn.jsdelivr.net","/npm/hls.js@^1.5.0/dist/hls",".min.js")}get ctor(){return this.sc}get instance(){return this.e.instance}get type(){return"hls"}get canLiveSync(){return!0}get config(){return this.e.sb}set config(t){this.e.sb=t}get library(){return this.pa}set library(t){this.pa=t}preconnect(){(0,e.isString)(this.pa)&&(0,n.TB)(this.pa)}setup(){super.setup(),new r(this.pa,this.b,(t=>{this.sc=t,this.e.setup(t),this.b.delegate.c("provider-setup",this);const i=(0,e.peek)(this.b.$state.source);i&&this.loadSource(i)}))}async loadSource(t,i){(0,e.isString)(t.src)?(this.a.preload=i||"",this.he(t,"application/x-mpegurl"),this.e.Wi(t),this.L=t):this.pc()}onInstance(t){const i=this.e.instance;return i&&t(i),this.e.tb.add(t),()=>this.e.tb.delete(t)}destroy(){this.e.Xi()}}o.supported=(0,n.m0)()}}]);
//# sourceMappingURL=884.5420f37f.chunk.js.map